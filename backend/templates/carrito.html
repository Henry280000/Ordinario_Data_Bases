{% extends 'base.html' %}

{% block title %}Carrito de Compras{% endblock %}

{% block content %}
<section class="section">
    <div style="max-width: 1000px; margin: 0 auto;">
        <h2 style="text-align: center; margin-bottom: 40px; font-weight: 900;">CARRITO DE COMPRAS</h2>
        
        {% if cart_items %}
        <table style="width: 100%; background: white; border-radius: 8px; overflow: hidden;">
            <thead style="background: #000; color: white;">
                <tr>
                    <th style="padding: 15px; text-align: left;">PRODUCTO</th>
                    <th style="padding: 15px;">TALLA</th>
                    <th style="padding: 15px;">PRECIO</th>
                    <th style="padding: 15px;">CANTIDAD</th>
                    <th style="padding: 15px;">SUBTOTAL</th>
                    <th style="padding: 15px;">ACCIONES</th>
                </tr>
            </thead>
            <tbody>
                {% for item in cart_items %}
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 15px;">
                        <strong>{{ item.nombre }}</strong><br>
                        <small style="color: #767677;">{{ item.equipo }}</small>
                    </td>
                    <td style="padding: 15px; text-align: center;">{{ item.size }}</td>
                    <td style="padding: 15px; text-align: center;">${{ "%.2f"|format(item.precio) }}</td>
                    <td style="padding: 15px; text-align: center;">
                        <form method="POST" action="{{ url_for('update_cart') }}" style="display: inline-flex; gap: 5px; align-items: center;">
                            <input type="hidden" name="cart_key" value="{{ item.cart_key }}">
                            <button type="submit" name="action" value="decrease" class="btn btn-secondary" style="padding: 5px 10px;">-</button>
                            <span style="padding: 0 10px; font-weight: 700;">{{ item.quantity }}</span>
                            <button type="submit" name="action" value="increase" class="btn btn-secondary" style="padding: 5px 10px;">+</button>
                        </form>
                    </td>
                    <td style="padding: 15px; text-align: center; font-weight: 700;">${{ "%.2f"|format(item.subtotal) }}</td>
                    <td style="padding: 15px; text-align: center;">
                        <form method="POST" action="{{ url_for('update_cart') }}" style="display: inline;">
                            <input type="hidden" name="cart_key" value="{{ item.cart_key }}">
                            <button type="submit" name="action" value="remove" class="btn btn-secondary" style="padding: 5px 15px;">ELIMINAR</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        <div style="text-align: right; margin-top: 30px;">
            <div style="background: white; padding: 30px; border-radius: 8px; display: inline-block; min-width: 400px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 24px; font-weight: 900;">
                    <span>TOTAL:</span>
                    <span style="color: #ff6b00;">${{ "%.2f"|format(total) }}</span>
                </div>
                <a href="{{ url_for('checkout') }}" class="btn btn-primary" style="width: 100%; font-size: 18px; padding: 15px;">
                    PROCEDER AL PAGO
                </a>
                <a href="{{ url_for('catalogo') }}" class="btn btn-secondary" style="width: 100%; font-size: 16px; padding: 12px; margin-top: 10px;">
                    SEGUIR COMPRANDO
                </a>
            </div>
        </div>
        {% else %}
        <div style="text-align: center; padding: 60px; background: white; border-radius: 8px;">
            <h3 style="font-weight: 700; margin-bottom: 20px;">Tu carrito está vacío</h3>
            <a href="{{ url_for('catalogo') }}" class="btn btn-primary">IR AL CATÁLOGO</a>
        </div>
        {% endif %}
    </div>
</section>
{% endblock %}
